
<!DOCTYPE html>
<html style="height: 100%">
<head>
   <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
     <title>水电费</title>
    <link rel="stylesheet" type="text/css" href="static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="static/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="static/css/ui-dialog.css">
    <script src="static/js/jquery.min.js"></script>
     <script src="static/js/dialog-min.js"></script>
    <script src="static/js/echart/echarts.min.js"></script>
    <style type="text/css">
    /* ------------------------------------------
      RESET  
    --------------------------------------------- */
    body, div,
    h1, h2, h3, h4, h5, h6,
    p, blockquote, pre, dl, dt, dd, ol, ul, li, hr,
    fieldset, form, label, legend, th, td,
    article, aside, figure, footer, header, hgroup, menu, nav, section,
    summary, hgroup {
      margin: 0;
      padding: 0;
      border: 0;
    }
    body{
        font-size:1.5em;
    }   
    a,a:active,a:hover {
      outline: 0;
      text-decoration: none;
    }
    html,body { height:100%; }
   
  /* basic css */

    .header {
  position: fixed;
  z-index: 1060;
  top: 0;
  right: 0;
  left: 0;
  height: 45px;
  border-bottom: 1px solid #43A382;
  background-color: #45A673;
  -webkit-box-shadow: 0 1px 1px rgba(98, 98, 98, 0.3);
  box-shadow: 0 1px 1px rgba(98, 98, 98, 0.3); }
  .header h1 {
    color: #fff;
    font-size: 18px;
    line-height: 44px;
    position: absolute;
    left: 50%;
    -webkit-transform: translate(-50%, 0);
    text-align: center;
    font-family: "YouYuan"; }
  .header .navbar-left {
    float: left;
    /*color: #fff;*/ }
    .header .navbar-left .back {
      color: #FFF;
      font-size: 2.5em; }
  .header .navbar-left > * {
    display: table-cell;
    height: 45px;
    padding-right: 10px;
    padding-left: 10px;
    vertical-align: middle; }

    .now {
  padding-top: 45px; 
  }
  .now .panel{
    margin-bottom: 0;
  }
  .now .month ,.now .year{
    font-size: 2rem; }
  .now .fa-calendar {
    color: #949594;
    display: table-cell;
    height: 45px;
    padding-left: 10px;
    vertical-align: middle;
    font-size: 2em; }

   .panel-body{
  padding:5px 15px;
    }
    #container{
    padding-bottom: 20px;
    height:60%;
    }


    </style>
</head>

<body>
    <div class="header">
        <div class="navbar-left">
           <a href="index.html"><i class="fa fa-angle-left back"></i></a>
        </div>
        <h1>水电费</h1>
    </div>
     <div class="now"> 
      <div class="panel panel-default">
          <div class="panel-heading"><span class="year">2016</span>/<span class="month">4</span>
               <span id="calender">
               <i class="fa fa-calendar pull-right" aria-hidden="true" data-event="test"></i>
               </span>
          </div>
      </div>
    </div>
  <div class="cost"> 
    <div class="panel ">
      <div class="panel-body">
        <div class="water">
          <span >水费</span>
              <div class="pull-right sum">￥24.28</div>
            </div>
            <hr/>
            <div class="electric">
               <span>电费</span>
               <div class="pull-right sum">￥174.28</div>
            </div>
      </div>
</div>

  </div>
    <div id="container"></div>
    <script type="text/javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    option = null;
    option = {
    // title: {
    //     text: '水电费折线图'
    // },
    tooltip : {
        trigger: 'axis'
    },
    legend: {
        data:['水费','电费']
    },
    // toolbox: {
    //     feature: {
    //         saveAsImage: {}
    //     }
    // },
    grid: {
        left: '3%',
        right: '6%',
        bottom: '3%',
        containLabel: true
    },
    color:['#009EFF','#EF6612'],

    xAxis : [
        {
            type : 'category',
            boundaryGap : false,
            data : ['一月份','二月份','三月份','四月份','五月份','六月份','七月份','八月份','九月份','十月份','十一月份','十二月份']
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
   series : [
       
        /* {
            name:'水费',
            type:'line',
            stack: '总量',
            areaStyle: {normal: {}},
            data:[320, 332, 301, 334, 390,320, 332, 301, 334, 390, 330, 320]
        },
        {
            name:'电费',
            type:'line',
            stack: '总量',
            label: {
                normal: {
                    show: true,
                    position: 'top',
                }
            },
            areaStyle: {normal: {}},
            data:[820, 932, 901, 934, 1290,460, 762, 681, 894, 1456, 465, 750]
        }*/
    ]
};

   if (option && typeof option === "object") {
        var startTime = +new Date();
        myChart.setOption(option, true);
        var endTime = +new Date();
        var updateTime = endTime - startTime;
        console.log("Time used:", updateTime);
    }

    CheckMessage=function(){
              $.ajax({
                  type: "GET",
                  async: false,
                  url: 'static/json/water.json',
                  dataType: "json",
                  success: function (result) {
                    console.log("success");

                      if(result.status==200){
                          option.series = [result.month[0].one[0],result.month[0].one[1]];
                          console.log(option.series);
                          myChart.hideLoading();
                          myChart.setOption(option);
                      }
                  },
                  error: function (a,b,c) {
                    alert("错误");
                  }
              });
            }
    $(document).ready(function() {
        CheckMessage();
    }); 
    </script>
      <script type="text/javascript">
      $('i[data-event=test]').on('click', function () {
        var d = dialog({
         title: '请选择月份',
          content: ' <input id="user_date" class="form-control" type="month"/>',
          height: 100,
          width: 300,
          okValue: '确 定',
          ok: function () {
            var x=$("#user_date").val();
            console.log(x);
            $(".month")[0].innerText=x[5]+x[6];
            $(".year")[0].innerText=x[0]+x[1]+x[2]+x[3]; 
            var y=$("#month").val();
            console.log(y);
            $(".drink")[0].innerText=y[5]+y[6];
            $(".elect")[0].innerText=y[5]+y[6];
            d.close().remove();
            CheckMessage=function(){
              $.ajax({
                  type: "GET",
                  async: false,
                  url: 'static/json/water.json',
                  dataType: "json",
                  success: function (result) {
                     console.log("success");
                      if(result.status ==200){

                          option.series = [result.month[1].one[0],result.month[1].one[1]];


                          myChart.hideLoading();
                          myChart.setOption(option);
                      }
                  },
                  error: function (errorMsg) {
                    alert("数据加载失败，请刷新")
                  }
              });
            } 
            CheckMessage();

          },
          cancelValue: '取 消',
          cancel: function () {}
        });

        d.showModal();
      });

    </script>
</body>
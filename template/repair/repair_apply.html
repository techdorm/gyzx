<!DOCTYPE html>
<html>
<head>
    <title>寝室报修</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1, maximum-scale=1, user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="../../static/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../static/font-awesome/css/font-awesome.min.css">
	<script type="text/javascript" src="../../static/js/jquery.min.js"></script>
	<script type="text/javascript" src="../../static/js/jquery.form-validator.js"></script>
	<link rel="stylesheet" href="../../stylesheets/apply.css">
	</head>
<body style="height:100%">
	 <div class="header">
        <div class="navbar-left">
           <a href="repair.html"><i class="fa fa-angle-left back"></i></a>
        </div>
        <h1>寝室报修</h1>
    </div>
	<div class="container">
        <div class="panel panel-default">
            <div class="panel-body">
                <form id="form" action="<?php echo($this->createMobileUrl('submit')); ?>" method="post">
                    <div class="form-group">
                        <label for="lh" class="control-label">楼号</label>
                        <select class="form-control" id="lh" name="lh" data-validation="select_required">
                            <option value="1">2号楼</option>
                            <option value="2">3号楼</option>
                            <option value="3">4号北楼</option>
                            <option value="4">4号南楼</option>
                            <option value="5">5号北楼</option>
                            <option value="6">5号南楼</option>
                            <option value="7">6号北楼</option>
                            <option value="8">6号南楼</option>
                            <option value="9">8号楼</option>
                            <option value="10">10号北楼</option>
                            <option value="11">10号南楼</option>
                            <option value="12">11号北楼</option>
                            <option value="13">11号南楼</option>
                            <option value="14">12号北楼</option>
                            <option value="15">12号南楼</option>
                            <option value="16">13号楼</option>
                            <option value="17">14号楼</option>
                            <option value="18">15号楼</option>
                            <option value="19">16号楼</option>
                            <option value="20">18号楼</option>
                            <option value="21">21号楼</option>
                            <option value="22">22号楼</option>
                            <option value="23">27号楼</option>
                            <option value="24">28号楼</option>
                            <option value="25">29号楼</option>
                            <option value="26">30号楼</option>
                            <option value="27">31号楼</option>
                            <option value="28">32号东楼</option>
                            <option value="29">32号西楼</option>
                            <option value="30">33号东一</option>
                            <option value="31">33号西二</option>
                            <option value="32">34号东一</option>
                            <option value="33">34号西二</option>
                            <option value="34">35号楼</option>
                            <option value="35">36号东一</option>
                            <option value="36">36号西二</option>
                            <option value="37">37号东一</option>
                            <option value="38">37号西二</option>
                            <option value="39">38号东一</option>
                            <option value="40">38号西二</option>
                            <option value="41">东校区13</option>
                            <option value="42">东校区14</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fjh" class="control-label">寝室号</label>
                        <input type="text" class="form-control" name="fjh" id="fjh" placeholder="请输入寝室号"  data-validation-error-msg="请填写寝室号">
                    </div>
                    <div class="form-group">
                        <label for="contact" class="control-label">报修人</label>
                        <input type="text" class="form-control" name="contact" id="contact" placeholder="请输入姓名" data-validation="required" data-validation-error-msg="请填写姓名">
                    </div>
                    <div class="form-group">
                        <label for="phone" class="control-label">手机</label>
                        <input type="tel" class="form-control" name="phone" id="phone" placeholder="请输入手机长号" data-validation="number_string" data-validation-length="11">
                    </div>
                    <div class="form-group">
                        <label for="bcatalogId" class="control-label">报修分类</label>
                        <select class="form-control" id="bcatalogId" name="bcatalogId" data-validation="select_required">
                            <option value="1">网络</option>
                            <option value="2">供暖</option>
                            <option value="3">电</option>
                            <option value="4">水</option>
                            <option value="5">门窗</option>
                            <option value="6">桌椅</option>
                            <option value="7">床</option>
                            <option value="8">衣柜</option>
                            <option value="9">通讯</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="remark" class="control-label">详细情况</label>
                        <textarea name="remark" class="form-control" id="remark" rows="5" placeholder="填写报修内容" data-validation="required" data-validation-error-msg="必须填写报修内容"></textarea>
                        <p style="float: right;color: #8d8d8d;">还可以输入<span id="maxlength">100</span>字</p>
                    </div>
                    <div class="form-group">
                        <label for="file" class="control-label">报修图片</label>
                        <input type="file" name="file" id="file" >
                    </div>
                    <div class="form-group" id="button">
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    $(document).ready(function() {
        if ('{$state}'=='already') {
            $('input').prop('disabled',true);
            $('select').prop('disabled',true);
            $("form").attr('id', 'already_form');
            $('#bcatalogId').val('{$res["bcatalogId"]}');
            $('#lh').val('{$res["lh"]}');
            $('#fjh').val('{$res["fjh1"]}');
            $('#contact').val('{$res["contact"]}');
            $('#phone').val('{$res["phone"]}');
            $('#remark').val('{$res["remark"]}');
            $('#file').val('{res["file"]}');
            $('<input type="submit" class="btn btn-info" id="modify" style="margin-right:10px;" value="修改">').appendTo('#button');
        } else{
            $('<input type="submit" class="btn btn-default" id="submit" style="margin-right:10px;" value="提交">\n<input type="reset" class="btn btn-danger" value="重置">').appendTo('#button');
            form_validate();
        };

        $("#already_form").submit(function(event) {
            event.preventDefault();
            $(this).unbind('submit');
            $(this).removeAttr('id');
            $('input').prop('disabled',false);
            $('select').prop('disabled',false);
            $("#button").empty();
            $('<input type="submit" class="btn btn-default" id="submit" style="margin-right:10px;" value="提交">\n<input type="reset" class="btn btn-danger" value="重置">').appendTo('#button');
            form_validate();
        });

        function form_validate () {
            var zh_cn = {
                lengthBadStart: '必须是 ',
                lengthBadEnd: ' 位',
            }
            $.validate({
                language : zh_cn,
            });
            $("textarea[name='remark']").restrictLength($('#maxlength'));
        }

        $('#submit').click(function(event) {
            console.log($('#file').val());
           alert($('#form').serialize());
        });
    });
    </script>
</body>
</html>
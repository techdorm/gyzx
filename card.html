<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>一卡通</title>
    <link rel="stylesheet" type="text/css" href="static/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="static/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/card.css">
    <link rel="stylesheet" type="text/css" href="static/css/dropload.css">
    <link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_1473158057_610199.css">
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/echart/echarts.min.js"></script>
    <link href="static/plugin/mobiscroll/css/mobiscroll.custom-3.0.0-beta4.min.css" rel="stylesheet" type="text/css" />
    <script src="static/plugin/mobiscroll/js/mobiscroll.custom-3.0.0-beta4.min.js" type="text/javascript"></script>

</head>

<body>
    <div class="header">
        <div class="navbar-left">
            <a href="index.html"><i class="fa fa-angle-left back"></i></a>
        </div>
        <h1>一卡通详情</h1>
        <div class="navbar-right">
            <button  id="lost"  class="btn btn-primary lost" >挂失</button>
        </div>
        
    </div>
    <div class="now">
        <div class="panel panel-default">
            <div class="panel-heading">
            <span class="demo-main-cont demo-comp-datetime demo-display-bottom demo-theme-mobiscroll">
                    <input id="demo" style="ime-mode: disabled" onfocus="this.blur();" class="demo-credit" placeholder="2016/9" />  
           
            </span>
                <span id="calender">
               <i class="fa fa-calendar pull-right" aria-hidden="true" data-event="test"></i>
               </span>
            </div>
        </div>
    </div>
    <div id="container" style="height:40%;margin-top:-10px;margin-bottom: -20px"></div>
    <div class="content">
        <div class="lists">
            <div class="item">
                <span class="icon-span"> <i class="icon iconfont icon-tongzhuangshui" ></i></span>
                <h3>
                    <p class="expense">-8.00</p>
                    <p class="detail">桶装水费</p>
                </h3>
                <div class="pull-right"> <span class="date">2014-14-14</span></div>
            </div>
            <div class="item">
                <span class="icon-span"><i class="icon iconfont icon-supermarke"></i></span>
                <h3>
                    <p class="expense">-23.50</p>
                    <p class="detail">超市消费</p>
                </h3>
                <div class="pull-right"> <span class="date">2014-14-14</span></div>
            </div>
            <div class="item">
                <span class="icon-span"> <i class="icon iconfont icon-restaurant" ></i></span>
                <h3>
                    <p class="expense">-8.00</p>
                    <p class="detail">食堂</p>
                </h3>
                <div class="pull-right"> <span class="date">2014-14-14</span></div>
            </div>
            <div class="item">
                <span class="icon-span"> <i class="icon iconfont icon-qita" ></i></span>
                <h3>
                    <p class="expense">-8.00</p>
                    <p class="detail">其他</p>
                </h3>
                <div class="pull-right"> <span class="date">2014-14-14</span></div>
            </div>
            <div class="item">
                <span class="icon-span"> <i class="icon iconfont icon-weixiu" ></i></span>
                <h3>
                    <p class="expense">-8.00</p>
                    <p class="detail">维修费</p>
                </h3>
                <div class="pull-right"> <span class="date">2014-14-14</span></div>
            </div>
            <div class="item">
                <span class="icon-span"> <i class="icon iconfont icon-qita"></i></span>
                <h3>
                    <p class="expense">-8.00</p>
                    <p class="detail">其他</p>
                </h3>
                <div class="pull-right"> <span class="date">2014-14-14</span></div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    $('#month').html(new Date().getMonth()+1);
    $('#year').html(new Date().getFullYear());
    $('#lost').click(function(event) {
        confirm("确定要挂失么？");
    });
    
    
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var app = {};
    option = null;
    option = {
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            data: ['消费额'],
            x: 'right'
        },
        grid: {
            left: '1%',
            top: '15%',
            right: '5%',
            containLabel: true
        },
       
        color: ['#009EFF'],
        xAxis: [{
            type: 'category',
            boundaryGap: false,
            data:['前7周','前6周','前5周','前4周','前3周','前2周','前1周','本周']
        }],
        yAxis: [{
            type: 'value'
        }],
        series: [{
            name: '消费额',
            type: 'line',
            stack: '总量',
            label: {
                normal: {
                    show: true,
                    position: 'top',
                }
            },
            areaStyle: {
                normal: {}
            },
            // data: [820, 932, 901, 934, 1290, 460, 762, 681]
            data: []
        }]
    };

     $.ajax({
        url: 'static/json/card.json',
        type: 'GET',
        dataType: 'json',
        success:function(result){
            option.series[0].data=result.week;
            myChart.setOption(option, true);
        }
    });
  
    </script>
    <script type="text/javascript">

      $(function () {
    
        // var now = new Date(),
        //     until = new Date(now.getFullYear(), now.getMonth());
          var start=new Date();
            var now = new Date(start.getFullYear(),start.getMonth()-2),
            until = new Date();
    
        // Mobiscroll Date & Time initialization
       
            $('#demo').mobiscroll().date({ 
                theme: 'ios',  // Specify theme like: theme: 'ios' or omit setting to use default
                lang: 'zh',           // Specify language like: lang: 'pl' or omit setting to use default
                display: 'bottom',    // Specify display mode like: display: 'bottom' or omit setting to use default
                dateWheels: 'yymm',   // More info about dateWheels: https://docs.mobiscroll.com/3-0-0_beta4/datetime#!localization-dateWheels
                dateFormat: 'yy/m',  // More info about dateFormat: https://docs.mobiscroll.com/3-0-0_beta4/datetime#!localization-dateFormat
                min: now,             // More info about min: https://docs.mobiscroll.com/3-0-0_beta4/datetime#!opt-min
                minWidth: 100,        // More info about minWidth: https://docs.mobiscroll.com/3-0-0_beta4/datetime#!opt-minWidth
                max: until            // More info about max: https://docs.mobiscroll.com/3-0-0_beta4/datetime#!opt-max
            });
        });
       $('#calender').click(function(){ 
            alert('sucess');
         });
    </script>
</body>
<script src="static/js/dropload.js"></script>
<script type="text/javascript">
$(function() {
    var counter = 0;
    // 每页展示4个
    var num = 4;
    var pageStart = 0,
        pageEnd = 0;
        //消费类型  顺序：餐厅、超市、桶装水、维修、水费、电费、图书馆、校医院、考试报名、保险、其他
     var type = ['icon-restaurant', 'icon-supermarke', 'icon-tongzhuangshui', 'icon-weixiu', 'icon-shuifei', 'icon-dianfei', 'icon-tushu', 'icon-yiyuan', 'icon-kaoshi', 'icon-baoxian', 'icon-qita'];
    // dropload
    $('.content').dropload({
        scrollArea: window,
       
        domDown: {
            domClass: 'dropload-down',
            domRefresh: '<div class="dropload-refresh">↑上拉加载更多</div>',
            domLoad: '<div class="dropload-load"><span class="loading"></span>拼命加载中...</div>',
            domNoData: '<div class="dropload-noData">暂无数据</div>'
        },
        loadDownFn: function(me) {
            $.ajax({
                type: 'GET',
                url: 'static/json/card.json',
                dataType: 'json',
                success: function(data) {
                    var result = '';
                    counter++;
                    pageEnd = num * counter;
                    pageStart = pageEnd - num;
                    for (var i = pageStart; i < pageEnd; i++) {
                        result += '<div class="item">' + '<span class="icon-span">' + '<i class="icon iconfont '+type[data.lists[i].feetype - 1]+'"></i>' + '</span>' + '<h3>' + '<p class="expense">' + data.lists[i].mondeal + '</p>' + '<p class="detail">' + data.lists[i].feename + '</p>' + '</h3>' + '<div class="pull-right">' + '<span class="date">' + data.lists[i].date + '</span>' + '</div>' + '</div>';
                        if ((i + 1) >= data.lists.length) {
                            // 锁定
                            me.lock();
                            // 无数据
                            me.noData();
                            break;
                        }
                    }
                    // 为了测试，延迟1秒加载
                    setTimeout(function() {
                        $('.lists').append(result);
                        // 每次数据加载完，必须重置
                        me.resetload();
                    }, 500);
                },
                error: function(xhr, type) {
                    alert('加载出错');
                    // 即使加载出错，也得重置
                    me.resetload();
                }
            });
        },
        threshold: 50
    });
});
</script>

</html>
